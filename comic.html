<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
  <link href="comic.css" rel="stylesheet">
  <link href="https://cdnjs.cloudflare.com/ajax/libs/extjs/6.2.0/classic/theme-classic/resources/theme-classic-all.css" rel="stylesheet" type="text/css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/extjs/6.2.0/ext-all.js" type="text/javascript"></script>
</head>
<body id="body">
  <button type="button" class="get_funny_joke" onclick="getID()">Get FuNnY JOKE!1!</button>
  <a href="index.html" class="go_to_index_page">Go Home</a>
  <script>
    function getID() {
      fetch('https://fwd.innopolis.app/api/hw2?email=a.shagaliev@innopolis.university')
        .then(val => val.json())
        .then(data => getJoke(data));
    }
    function getJoke(id) {
      fetch('https://fwd.innopolis.university/api/comic?id=' + id)
        .then(val => val.json())
        .then(val => {
          // creating all elements recieved from the response
          const img_div = document.createElement("div");
          const img = document.createElement('img');
          img.src = val.img;
          img.alt = val.alt;
          img_div.append(img);

          const title_div = document.createElement('div');
          title_div.textContent = 'Title: ' + val.safe_title;

          const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' };
          const date_div = document.createElement('div');
          date_div.textContent = 'Published: ' + document.createTextNode(new Date(Date.UTC(Number(val.year), Number(val.month), Number(val.day), 0, 0, 0)).toLocaleDateString(undefined, options)).textContent;

          // styling recieved elements
          title_div.style.fontSize = "30px";
          title_div.style.marginLeft = "16px";

          date_div.style.fontSize = "20px";
          date_div.style.fontStyle = "italic";

          // creating grid
          var scaffold = document.createElement('div');
          scaffold.class = 'wrapper';

          // adding children to our grid
          scaffold.appendChild(title_div);
          scaffold.appendChild(img_div);
          scaffold.appendChild(date_div);
          scaffold.style.display = "grid";
          scaffold.style.gridTemplateColumns = "auto auto auto";
          scaffold.style.margin = "32px";

          // putting or grid element into our document body
          var body = document.getElementById('body');
          body.appendChild(scaffold);
        });
    }
  </script>
</body>
</html>
